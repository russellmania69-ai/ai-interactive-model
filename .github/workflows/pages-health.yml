name: Pages Health Check

on:
  schedule:
    - cron: '*/10 * * * *'
  workflow_dispatch: {}

jobs:
  check:
    runs-on: ubuntu-latest
    steps:
      - name: Check health JSON
        run: |
          set -e
          URL="https://russellmania69-ai.github.io/ai-interactive-model/health.json"
          echo "Checking $URL"
          BODY=$(curl -sS "$URL" || true)
          if [ -z "$BODY" ]; then
            echo "no response from $URL" && exit 1
          fi
          echo "$BODY" | grep -q '"status":' || (echo "invalid body: $BODY" && exit 1)
          OK=$(echo "$BODY" | grep -o '"status"[[:space:]]*:[[:space:]]*"ok"' || true)
          if [ -z "$OK" ]; then
            echo "health status not ok: $BODY" && exit 1
          fi
